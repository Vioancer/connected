{"version":3,"sources":["app/hooks/useAxios.tsx","app/pages/app/containers/Public.tsx"],"names":["useAxios","url","method","data","useState","loading","setLoading","serverData","setServerData","error","setError","useEffect","a","axios","res","getData","Public","posts","setPosts","io","useContext","SocketContext","length","on","prevProps","unshift","postIndex","findIndex","el","_id","Array","fill","map","_","i","PostSkeleton","to","p","md","sm","post","Post"],"mappings":"+MAuCeA,EAhC0C,SACxDC,GAGK,IAFLC,EAEI,uDAFK,MACTC,EACI,yCAC0BC,oBAAS,GADnC,mBACGC,EADH,KACYC,EADZ,OAEgCF,mBAAS,MAFzC,mBAEGG,EAFH,KAEeC,EAFf,OAGsBJ,mBAAS,MAH/B,mBAGGK,EAHH,KAGUC,EAHV,KAyBJ,OApBAC,qBAAU,YACI,uCAAG,4BAAAC,EAAA,6DACfN,GAAW,GADI,kBAGmBO,IAAM,CACtCX,SACAD,MACAE,SANa,OAGRW,EAHQ,OASdN,EAAcM,EAAIX,MATJ,gDAWdO,EAASD,GAXK,QAafH,GAAW,GAbI,yDAAH,qDAgBbS,KACE,CAACb,EAAQD,EAAKE,EAAMM,IAEhB,CAAEJ,UAASE,aAAYE,U,2BCqChBO,UA9DU,WAAO,IAAD,EACShB,EAAS,iBAAxCK,EADsB,EACtBA,QAASE,EADa,EACbA,WAAYE,EADC,EACDA,MADC,EAEJL,mBAAsB,IAFlB,mBAEvBa,EAFuB,KAEhBC,EAFgB,KAGxBC,EAAKC,qBAAWC,KA6BtB,OA3BAV,qBAAU,YACJN,GAAWE,GAAcA,EAAWU,MAAMK,OAAS,GACvDJ,EAASX,EAAWU,SAEnB,CAACV,EAAYF,IAEhBM,qBAAU,WAETQ,EAAGI,GAAG,WAAW,SAACpB,GACjBe,GAAS,SAACM,GACT,IAAMP,EAAK,YAAOO,GAElB,OADAP,EAAMQ,QAAQtB,GACPc,QAKTE,EAAGI,GAAG,eAAe,SAACpB,GACrBe,GAAS,SAACM,GACT,IAAIP,EAAK,YAAOO,GACVE,EAAYT,EAAMU,WAAU,SAACC,GAAD,OAAQA,EAAGC,MAAQ1B,EAAK0B,OAE1D,OADAZ,EAAMS,GAAN,eAAwBvB,GACjBc,UAGP,CAACE,IAEAd,EAEF,mCACEyB,MAAM,IACLC,KAAK,GACLC,KAAI,SAACC,EAAGC,GACR,OAAO,cAACC,EAAA,EAAD,GAAmBD,QAM3BzB,EACI,cAAC,IAAD,CAAU2B,GAAG,SAIpB,cAAC,IAAD,CACCC,EAAG,CACFC,GAAI,GACJC,GAAI,GAHN,SAKEtB,GACAA,EAAMe,KAAI,SAACQ,GACV,OAAO,cAACC,EAAA,EAAD,CAAMD,KAAMA,GAAWA,EAAKX","file":"static/js/16.e314a2dc.chunk.js","sourcesContent":["import { useEffect, useState } from 'react';\r\nimport axios, { AxiosResponse } from 'axios';\r\n\r\nconst useAxios: (\r\n\turl: string,\r\n\tmethod?: 'get' | 'post' | 'patch' | 'delete',\r\n\tdata?: any\r\n) => { loading: boolean; serverData: any; error: any } = (\r\n\turl,\r\n\tmethod = 'get',\r\n\tdata\r\n) => {\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [serverData, setServerData] = useState(null);\r\n\tconst [error, setError] = useState(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst getData = async () => {\r\n\t\t\tsetLoading(true);\r\n\t\t\ttry {\r\n\t\t\t\tconst res: AxiosResponse = await axios({\r\n\t\t\t\t\tmethod,\r\n\t\t\t\t\turl,\r\n\t\t\t\t\tdata,\r\n\t\t\t\t});\r\n\r\n\t\t\t\tsetServerData(res.data);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tsetError(error);\r\n\t\t\t}\r\n\t\t\tsetLoading(false);\r\n\t\t};\r\n\r\n\t\tgetData();\r\n\t}, [method, url, data, error]);\r\n\r\n\treturn { loading, serverData, error };\r\n};\r\n\r\nexport default useAxios;\r\n","import { Box } from '@chakra-ui/react';\r\nimport React, { useContext, useState } from 'react';\r\nimport { useEffect } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport useAxios from '../../../hooks/useAxios';\r\nimport { SocketContext } from '../../../store/context/SocketContext';\r\nimport Post from '../components/Post';\r\nimport PostSkeleton from '../components/PostSkeleton';\r\n\r\nimport { Post as PostProps } from './../../../config/types';\r\n\r\nconst Public: React.FC = () => {\r\n\tconst { loading, serverData, error } = useAxios('/api/v1/posts');\r\n\tconst [posts, setPosts] = useState<PostProps[]>([]);\r\n\tconst io = useContext(SocketContext);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!loading && serverData && serverData.posts.length > 0) {\r\n\t\t\tsetPosts(serverData.posts);\r\n\t\t}\r\n\t}, [serverData, loading]);\r\n\r\n\tuseEffect(() => {\r\n\t\t// new post\r\n\t\tio.on('newPost', (data: PostProps) => {\r\n\t\t\tsetPosts((prevProps: PostProps[]) => {\r\n\t\t\t\tconst posts = [...prevProps];\r\n\t\t\t\tposts.unshift(data);\r\n\t\t\t\treturn posts;\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// update post\r\n\t\tio.on('updatedPost', (data: PostProps) => {\r\n\t\t\tsetPosts((prevProps: PostProps[]) => {\r\n\t\t\t\tlet posts = [...prevProps];\r\n\t\t\t\tconst postIndex = posts.findIndex((el) => el._id === data._id);\r\n\t\t\t\tposts[postIndex] = { ...data };\r\n\t\t\t\treturn posts;\r\n\t\t\t});\r\n\t\t});\r\n\t}, [io]);\r\n\r\n\tif (loading) {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t{Array(10)\r\n\t\t\t\t\t.fill(0)\r\n\t\t\t\t\t.map((_, i) => {\r\n\t\t\t\t\t\treturn <PostSkeleton key={i} />;\r\n\t\t\t\t\t})}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tif (error) {\r\n\t\treturn <Redirect to='/404' />;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Box\r\n\t\t\tp={{\r\n\t\t\t\tmd: 10,\r\n\t\t\t\tsm: 4,\r\n\t\t\t}}>\r\n\t\t\t{posts &&\r\n\t\t\t\tposts.map((post: PostProps) => {\r\n\t\t\t\t\treturn <Post post={post} key={post._id} />;\r\n\t\t\t\t})}\r\n\t\t</Box>\r\n\t);\r\n};\r\n\r\nexport default Public;\r\n"],"sourceRoot":""}