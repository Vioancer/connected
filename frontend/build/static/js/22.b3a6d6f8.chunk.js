(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[22],{530:function(e,a,t){"use strict";t.r(a);var r=t(1),s=t(6),n=t(16),i=t.n(n),o=t(27),c=t(0),l=t.n(c),d=t(65),u=t(31),m=t.n(u),p=t(33),b=t(21),j=t(430),h=t(137),f=t(477),x=t(479),O=t(433),g=t(244),w=t(484),v=t(473),y=t(522),N=t(158),C=t(504),S=t(512),P=t(513),I=t(121),k=t(102),A=t(20),q=t(94),F={outerContainer:{mx:{lg:10,md:4},h:"90vh",overflowY:"scroll"},innerContainer:{py:10,rowGap:{sm:10,md:0},h:{lg:"65vh",sm:"auto"},columns:{lg:2,md:1},justifyItems:"center"},iconbtn:{cursor:"pointer",bgGradient:"linear(primary.600, secondary.400)",pos:"absolute",borderRadius:"50%",transition:"all .3s ease-out",_hover:{bgGradient:"linear(secondary.400, primary.500)"},_active:{bgGradient:"linear(secondary.400, primary.500)"}}},U=l.a.lazy((function(){return Promise.resolve().then(t.bind(null,164))})),V=l.a.lazy((function(){return Promise.resolve().then(t.bind(null,133))})),z=l.a.lazy((function(){return Promise.resolve().then(t.bind(null,104))})),D=d.a().shape({firstName:d.c().required("Please provide your firstname"),lastName:d.c().required("Please provide your lastname"),email:d.c().email("Please provide a valid email").required("Please provide your email")}),G=d.a().shape({currentPassword:d.c().required("provide your current password"),password:d.c().min(6,"Password should atleast contain a minimum of 6 characters").required("Please protect your account with a password"),passwordConfirm:d.c().when("password",{is:function(e){return!!(e&&e.length>0)},then:d.c().oneOf([d.b("password")],"passwords do not match")}).required("Confirm your password")});a.default=function(){var e=Object(c.useContext)(A.a),a=e.user,t=e.updateUser,n=Object(j.b)().colorMode,l=Object(I.a)(),d=l.image,u=l.setImage,H=l.showImageCropper,T=l.closeImageCropper,J=l.imageSettings,E=l.setImageSettings,L=l.imageUrl,M=l.setCroppedImage,R=l.croppedImage,Y=l.openImageCropper,_=l.resetValues,B={firstName:a.firstName,middleName:a.middleName||"",lastName:a.lastName,email:a.email},K=function(){var e=Object(o.a)(i.a.mark((function e(){var a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("photo",d),a.append("imageSettings",JSON.stringify(J)),e.prev=3,e.next=6,m()({url:"/api/v1/users/updateSettings",method:"PATCH",data:a});case 6:r=e.sent,t(r.data.user),_(),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(3);case 13:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}(),Q=Object(k.a)(),W=Q.setAlert,X=Q.isAlertOpen,Z=Q.alertDetails,$=Object(b.g)();return Object(r.jsxs)(c.Suspense,{fallback:Object(r.jsx)(q.default,{}),children:[X&&Object(r.jsx)(z,{alertDetails:Z}),d&&L&&Object(r.jsx)(V,{showImageCropper:H,closeImageCropper:T,imageSettings:J,setImageSettings:E,photo:L,setCroppedImage:M}),Object(r.jsxs)(h.a,Object(s.a)(Object(s.a)({bgColor:"light"===n?"secondary.100":"gray.700"},F.outerContainer),{},{className:"hide-scrollbar",p:5,children:[Object(r.jsx)(h.a,{mb:{lg:20,sm:2},textAlign:"center",children:Object(r.jsx)(f.a,{children:"My Profile"})}),Object(r.jsxs)(x.a,Object(s.a)(Object(s.a)({},F.innerContainer),{},{children:[Object(r.jsxs)(h.a,{alignSelf:"center",w:"max-content",pos:"relative",children:[Object(r.jsx)(O.a,{borderRadius:"0",boxSize:"400px",src:R||a&&a.photo,alt:a&&a.firstName}),Object(r.jsx)("input",{onChange:function(e){return u(e.target.files[0])},type:"file",name:"image-upload",id:"image-upload",style:{display:"none"}}),Object(r.jsxs)(g.a,{children:[d&&Object(r.jsx)(w.a,{hasArrow:!0,label:"Save Photo",children:Object(r.jsx)(v.a,Object(s.a)(Object(s.a)({bottom:"20px",right:"100px",onClick:K},F.iconbtn),{},{"aria-label":"save photo",icon:Object(r.jsx)(C.a,{color:"#fff"})}))}),d&&Object(r.jsx)(w.a,{hasArrow:!0,label:"Edit Photo",children:Object(r.jsx)(v.a,Object(s.a)(Object(s.a)({bottom:"20px",right:"55px",onClick:Y},F.iconbtn),{},{"aria-label":"edit photo",icon:Object(r.jsx)(S.a,{color:"#fff"})}))}),Object(r.jsx)(w.a,{hasArrow:!0,label:"Change Photo",children:Object(r.jsx)(v.a,Object(s.a)(Object(s.a)({bottom:"20px",right:"10px",as:"label",htmlFor:"image-upload"},F.iconbtn),{},{"aria-label":"change photo",icon:Object(r.jsx)(P.a,{color:"#fff"})}))})]})]}),Object(r.jsx)(h.a,{alignSelf:"center",w:"100%",children:Object(r.jsxs)(y.e,{children:[Object(r.jsxs)(y.b,{children:[Object(r.jsx)(y.a,{children:"Update Settings"}),Object(r.jsx)(y.a,{children:"Update Password"})]}),Object(r.jsxs)(y.d,{children:[Object(r.jsx)(y.c,{children:Object(r.jsx)(p.c,{validationSchema:D,initialValues:B,onSubmit:function(){var e=Object(o.a)(i.a.mark((function e(a,r){var s,n,o,c,l,d,u,p,b;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.setSubmitting,n=r.resetForm,o=a.firstName,c=a.middleName,l=a.lastName,d=a.email,(u=new FormData).append("firstName",o),c&&""!==c.trim()&&u.append("middleName",c),u.append("lastName",l),u.append("email",d),e.prev=7,e.next=10,m()({url:"/api/v1/users/updateSettings",method:"PATCH",data:u});case 10:p=e.sent,t(p.data.user),b={firstName:p.data.user.firstName,middleName:p.data.user.middleName||"",lastName:p.data.user.lastName,email:p.data.user.email},_(),n({values:b}),W("success","user details updated succesfully"),s(!1),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(7),W("error","could not update user details"),s(!1);case 23:case"end":return e.stop()}}),e,null,[[7,19]])})));return function(a,t){return e.apply(this,arguments)}}(),children:function(e){var a=e.dirty,t=e.isValid,s=e.isSubmitting;return Object(r.jsxs)(h.a,{as:p.b,minH:"400px",autoComplete:"off",children:[Object(r.jsx)(U,{name:"firstName",label:"firstName"}),Object(r.jsx)(U,{required:!1,name:"middleName",label:"middleName"}),Object(r.jsx)(U,{name:"lastName",label:"lastName"}),Object(r.jsx)(U,{name:"email",label:"Email"}),t&&a&&Object(r.jsx)(N.a,{isLoading:s,type:"submit",colorScheme:"primary",children:"Save"})]})}})}),Object(r.jsx)(y.c,{children:Object(r.jsx)(p.c,{validationSchema:G,initialValues:{currentPassword:"",password:"",passwordConfirm:""},onSubmit:function(){var e=Object(o.a)(i.a.mark((function e(a,t){var r,n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.setSubmitting,n=t.resetForm,o=Object(s.a)({},a),e.prev=2,e.next=5,m()({url:"/api/v1/users/updateCurrentUserPassword",method:"POST",data:o});case 5:n(),W("success","user password updated succesfully. You will be logged out..."),r(!1),setTimeout((function(){$.replace("/auth/logout")}),2e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),W("error",e.t0.response.data.message),r(!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(a,t){return e.apply(this,arguments)}}(),children:function(e){var a=e.dirty,t=e.isValid,s=e.isSubmitting;return Object(r.jsxs)(h.a,{minH:"400px",as:p.b,autoComplete:"off",children:[Object(r.jsx)(U,{name:"currentPassword",label:"Current Password",type:"password"}),Object(r.jsx)(U,{type:"password",name:"password",label:"New Password"}),Object(r.jsx)(U,{name:"passwordConfirm",label:"Password Confirm",type:"password"}),Object(r.jsx)(N.a,{disabled:!a&&t||a&&!t,isLoading:s,type:"submit",colorScheme:"primary",children:"Save"})]})}})})]})]})})]}))]}))]})}}}]);
//# sourceMappingURL=22.b3a6d6f8.chunk.js.map