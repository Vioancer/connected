(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[19],{525:function(e,a,t){"use strict";t.r(a);var r=t(1),s=t(5),n=t(8),i=t.n(n),o=t(17),c=t(430),l=t(137),d=t(479),m=t(480),p=t(433),u=t(244),b=t(485),j=t(473),h=t(517),f=t(157),x=t(0),O=t(22),g=t(477),w=t(510),v=t(511),y=t(163),N=t(35),C=t(65),S=t(121),P=t(122),I=t(19),k=t.n(I),A=t(102),q=t(24),F=t(103),U={outerContainer:{mx:{lg:10,md:4},h:"90vh",overflowY:"scroll"},innerContainer:{py:10,rowGap:{sm:10,md:0},h:{lg:"65vh",sm:"auto"},columns:{lg:2,md:1},justifyItems:"center"},iconbtn:{cursor:"pointer",bgGradient:"linear(primary.600, secondary.400)",pos:"absolute",borderRadius:"50%",transition:"all .3s ease-out",_hover:{bgGradient:"linear(secondary.400, primary.500)"},_active:{bgGradient:"linear(secondary.400, primary.500)"}}},V=C.a().shape({firstName:C.c().required("Please provide your firstname"),lastName:C.c().required("Please provide your lastname"),email:C.c().email("Please provide a valid email").required("Please provide your email")}),D=C.a().shape({currentPassword:C.c().required("provide your current password"),password:C.c().min(6,"Password should atleast contain a minimum of 6 characters").required("Please protect your account with a password"),passwordConfirm:C.c().when("password",{is:function(e){return!!(e&&e.length>0)},then:C.c().oneOf([C.b("password")],"passwords do not match")}).required("Confirm your password")});a.default=function(){var e=Object(x.useContext)(O.a),a=e.user,t=e.updateUser,n=Object(c.b)().colorMode,C=Object(S.a)(),I=C.image,G=C.setImage,H=C.showImageCropper,T=C.closeImageCropper,J=C.imageSettings,E=C.setImageSettings,L=C.imageUrl,M=C.setCroppedImage,R=C.croppedImage,Y=C.openImageCropper,_=C.resetValues,z={firstName:a.firstName,middleName:a.middleName||"",lastName:a.lastName,email:a.email},B=function(){var e=Object(o.a)(i.a.mark((function e(){var a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("photo",I),a.append("imageSettings",JSON.stringify(J)),e.prev=3,e.next=6,k()({url:"/api/v1/users/updateSettings",method:"PATCH",data:a});case 6:r=e.sent,t(r.data.user),_(),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(3);case 13:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}(),K=Object(A.a)(),Q=K.setAlert,W=K.isAlertOpen,X=K.alertDetails,Z=Object(q.g)();return Object(r.jsxs)(r.Fragment,{children:[W&&Object(r.jsx)(F.a,{alertDetails:X}),I&&L&&Object(r.jsx)(P.a,{showImageCropper:H,closeImageCropper:T,imageSettings:J,setImageSettings:E,photo:L,setCroppedImage:M}),Object(r.jsxs)(l.a,Object(s.a)(Object(s.a)({bgColor:"light"===n?"secondary.100":"gray.700"},U.outerContainer),{},{className:"hide-scrollbar",p:5,children:[Object(r.jsx)(l.a,{mb:{lg:20,sm:2},textAlign:"center",children:Object(r.jsx)(d.a,{children:"My Profile"})}),Object(r.jsxs)(m.a,Object(s.a)(Object(s.a)({},U.innerContainer),{},{children:[Object(r.jsxs)(l.a,{alignSelf:"center",w:"max-content",pos:"relative",children:[Object(r.jsx)(p.a,{borderRadius:"0",boxSize:"400px",src:R||a&&a.photo,alt:a&&a.firstName}),Object(r.jsx)("input",{onChange:function(e){return G(e.target.files[0])},type:"file",name:"image-upload",id:"image-upload",style:{display:"none"}}),Object(r.jsxs)(u.a,{children:[I&&Object(r.jsx)(b.a,{hasArrow:!0,label:"Save Photo",children:Object(r.jsx)(j.a,Object(s.a)(Object(s.a)({bottom:"20px",right:"100px",onClick:B},U.iconbtn),{},{"aria-label":"save photo",icon:Object(r.jsx)(g.a,{color:"#fff"})}))}),I&&Object(r.jsx)(b.a,{hasArrow:!0,label:"Edit Photo",children:Object(r.jsx)(j.a,Object(s.a)(Object(s.a)({bottom:"20px",right:"55px",onClick:Y},U.iconbtn),{},{"aria-label":"edit photo",icon:Object(r.jsx)(w.a,{color:"#fff"})}))}),Object(r.jsx)(b.a,{hasArrow:!0,label:"Change Photo",children:Object(r.jsx)(j.a,Object(s.a)(Object(s.a)({bottom:"20px",right:"10px",as:"label",htmlFor:"image-upload"},U.iconbtn),{},{"aria-label":"change photo",icon:Object(r.jsx)(v.a,{color:"#fff"})}))})]})]}),Object(r.jsx)(l.a,{alignSelf:"center",w:"100%",children:Object(r.jsxs)(h.e,{children:[Object(r.jsxs)(h.b,{children:[Object(r.jsx)(h.a,{children:"Update Settings"}),Object(r.jsx)(h.a,{children:"Update Password"})]}),Object(r.jsxs)(h.d,{children:[Object(r.jsx)(h.c,{children:Object(r.jsx)(N.c,{validationSchema:V,initialValues:z,onSubmit:function(){var e=Object(o.a)(i.a.mark((function e(a,r){var s,n,o,c,l,d,m,p,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.setSubmitting,n=r.resetForm,o=a.firstName,c=a.middleName,l=a.lastName,d=a.email,(m=new FormData).append("firstName",o),c&&""!==c.trim()&&m.append("middleName",c),m.append("lastName",l),m.append("email",d),e.prev=7,e.next=10,k()({url:"/api/v1/users/updateSettings",method:"PATCH",data:m});case 10:p=e.sent,t(p.data.user),u={firstName:p.data.user.firstName,middleName:p.data.user.middleName||"",lastName:p.data.user.lastName,email:p.data.user.email},_(),n({values:u}),Q("success","user details updated succesfully"),s(!1),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(7),Q("error","could not update user details"),s(!1);case 23:case"end":return e.stop()}}),e,null,[[7,19]])})));return function(a,t){return e.apply(this,arguments)}}(),children:function(e){var a=e.dirty,t=e.isValid,s=e.isSubmitting;return Object(r.jsxs)(l.a,{as:N.b,minH:"400px",autoComplete:"off",children:[Object(r.jsx)(y.a,{name:"firstName",label:"firstName"}),Object(r.jsx)(y.a,{required:!1,name:"middleName",label:"middleName"}),Object(r.jsx)(y.a,{name:"lastName",label:"lastName"}),Object(r.jsx)(y.a,{name:"email",label:"Email"}),t&&a&&Object(r.jsx)(f.a,{isLoading:s,type:"submit",colorScheme:"primary",children:"Save"})]})}})}),Object(r.jsx)(h.c,{children:Object(r.jsx)(N.c,{validationSchema:D,initialValues:{currentPassword:"",password:"",passwordConfirm:""},onSubmit:function(){var e=Object(o.a)(i.a.mark((function e(a,t){var r,n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.setSubmitting,n=t.resetForm,o=Object(s.a)({},a),e.prev=2,e.next=5,k()({url:"/api/v1/users/updateCurrentUserPassword",method:"POST",data:o});case 5:n(),Q("success","user password updated succesfully. You will be logged out..."),r(!1),setTimeout((function(){Z.replace("/auth/logout")}),2e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),Q("error",e.t0.response.data.message),r(!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(a,t){return e.apply(this,arguments)}}(),children:function(e){var a=e.dirty,t=e.isValid,s=e.isSubmitting;return Object(r.jsxs)(l.a,{minH:"400px",as:N.b,autoComplete:"off",children:[Object(r.jsx)(y.a,{name:"currentPassword",label:"Current Password",type:"password"}),Object(r.jsx)(y.a,{type:"password",name:"password",label:"New Password"}),Object(r.jsx)(y.a,{name:"passwordConfirm",label:"Password Confirm",type:"password"}),Object(r.jsx)(f.a,{disabled:!a&&t||a&&!t,isLoading:s,type:"submit",colorScheme:"primary",children:"Save"})]})}})})]})]})})]}))]}))]})}}}]);
//# sourceMappingURL=19.67a6c05e.chunk.js.map